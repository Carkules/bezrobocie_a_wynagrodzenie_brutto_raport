---
title: "Analiza bezrobocia rejestrowanego w Polsce w latach 2015-2024 na poziomie powiatów"
format: pdf
editor: visual
author: "Konrad Słotta i Kacper Łazurkiewicz"
lang: pl
bibliography: bezrobocie_bibliografia.bib
nocite: "@*"
crossref:
  fig-title: "Rysunek"
execute:
  echo: false
  warning: false
  message: false
---

## Wstęp

### Czym jest bezrobocie rejestrowane?

Bezrobocie rejestrowane to forma bezrobocia obejmująca osoby, które zgłosiły się do powiatowego urzędu pracy i zostały wpisane do oficjalnego rejestru bezrobotnych. Oznacza to, że dana osoba nie ma zatrudnienia, aktywnie poszukuje pracy i jest gotowa ją podjąć, spełniając jednocześnie warunki określone w przepisach. Ludzie rejestrują się w urzędzie pracy z różnych powodów – przede wszystkim w celu znalezienia zatrudnienia za pośrednictwem urzędu, ale także po to, aby uzyskać wsparcie finansowe w postaci zasiłku, jeśli spełniają kryteria jego przyznania. Rejestracja zapewnia także prawo do ubezpieczenia zdrowotnego opłacanego przez państwo, co ma znaczenie szczególnie dla osób pozostających bez pracy i bez innego tytułu do ubezpieczenia. Dodatkowo zarejestrowani bezrobotni mogą korzystać z ofert bezpłatnych szkoleń, kursów zawodowych, staży czy programów aktywizacyjnych, które pomagają w powrocie na rynek pracy. Warto zaznaczyć, że bezrobocie rejestrowane jest tylko jedną z miar bezrobocia, ponieważ obejmuje wyłącznie osoby, które faktycznie zgłosiły się do urzędu – nie uwzględnia osób poszukujących pracy na własną rękę ani tych, które pracują nieformalnie (na czarno), dlatego nie odzwierciedla całkowitej liczby osób pozostających bez zatrudnienia.

### Jak zbierane są dane?

Podstawowymi sposobami zbierania danych przez GUS są źródła administracyjne (dane publiczne), spisy powszechne oraz badania ankietowe. Źródła administracyjne obejmują informacje pochodzące z rejestrów prowadzonych przez instytucje publiczne, takie jak urzędy skarbowe, Zakład Ubezpieczeń Społecznych czy urzędy pracy. Spisy powszechne są badaniami obejmującymi całą populację lub jej dużą część i pozwalają na uzyskanie szczegółowych danych dotyczących m.in. ludności, mieszkań i gospodarstw domowych. Natomiast badania ankietowe prowadzone przez GUS mogą mieć charakter ciągły, cykliczny lub jednorazowy i są realizowane na wybranej próbie respondentów, co umożliwia systematyczne monitorowanie zjawisk społecznych i gospodarczych.

### Opisanie Zmiennych w danych

Zmienna "Powiat" to nazwa powiatu w którym zostały zebrane dane.

Zmienna "Kod" to numer statystyczny konkretnego powiatu (każdy powiat ma swój indywidualny Kod).

Zmienna "Płeć" przyjmuje 3 stany (Mężczyzna, Kobieta, Ogółem) czyli mówi nam czy szereg pozostałych zmiennych był rozpatrywany pod kątem jakiejś konkretnej płci czy badany był ogółem.

Zmienna "Ludność" mówi nam ile osób było mieszkańcami danego powiatu na końcu konkretnego roku.

Zmienna "Bezrobotni" mówi nam o liczbie mieszkańców danego powiatu którzy mają status Bezrobocia Rejestrowanego w danym roku (tutaj nie wiemy nic o bezrobociu nierejestrowanym).

Zmienna "Ludność_wiek_prod" mówi nam o liczbie mieszkańców danego powiatu którzy są w wieku produkcyjnym (miedzy 18 a 59/64 odpowiednio dla kobiet/mężczyzn) na koniec danego roku.

Zmienna "Wynagrodzenie_przeciętne" mówi nam o średnich zarobkach brutto przez mieszkańców danego powiatu (ta zmienna nie ma rozróżnienia na płcie). Brak danych jest spowodowany tym że GUS nie oferuje informacji o wynagrodzeniach dla mężczyzn i kobiet osobno, tylko dla ogółu.

### Pytania badawcze

Te oryginalne a) Czy jako bezrobotne rejestrują się częściej kobiety, czy mężczyźni w Polsce? b) Czy wskaźnik bezrobocia jest wyższy w powiatach, gdzie jest niższe przeciętne wynagrodzenie brutto, czy wyższe? c) Czy zależności a) i b) wyglądają inaczej w dużych miastach (miastach na prawach powiatu, powyżej 100 tys. mieszkańców)? d) Czy zależności a) i b) są stałe w czasie, czy zmieniły się w ostatnich 10 latach?

Moja propozycja modyfikacji(jeśli potrzebna)

1)  Czy jako bezrobotne rejestrują się częściej kobiety, czy mężczyźni w Polsce w skali czasu? +1.1) Czy jako bezrobotne rejestrują się częściej kobiety w skali liczby kobiet, czy mężczyźni w skali liczby mężczyzn w Polsce w skali czasu?

2)  Czy wskaźnik bezrobocia jest wyższy w powiatach, gdzie jest niższe przeciętne wynagrodzenie brutto, czy wyższe przeciętne wynagrodzenie brutto ? (to samo) ( w jakims konkternym roku?)

3)  Czy zależność 1) i 1.1) wygląda inaczej w małych powiatach i w dużych powiatach(duże powiaty czyli powyżej 100tyś mieszkańców) ??(Niektóre powiaty mają +100tys mieszkancow a potem pozizej 100tys wiec takim kryterium moze zrobimy że (if max(Ludność(Ogółem,Rok)) \>100tys) to kwalifikujemy na duże powaity? )??

## Wczytanie danych

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(knitr)
library(kableExtra)
```

```{r}
data <- read.csv("sprawozdanie1_dane.csv")
```

## Analiza danych

### Obliczanie krajowej stopy bezrobocia rejestrowanego

Stopa bezrobocia rejestrowanego to stosunek liczby osób bezrobotnych do całkowitej liczby ludności w wieku produkcyjnym. Na podstawie przyjętych danych powiatowych obliczyliśmy krajową stopę bezrobocia w poszczególnych latach z podziałem na płeć. Wyniki zostały przedstawione na wykresie słupkowym poniżej.

```{r}
data_mod <- data |> mutate(stopa_bezrobocia = Bezrobotni/Ludność_wiek_prod)
```

```{r}
#| label: fig_1
#| fig-cap: "Krajowa stopa bezrobocia w ostatnich 10 latach"
data_mod |> group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = sum(Bezrobotni)/sum(Ludność_wiek_prod)) |>
  ggplot(aes(x=factor(Rok), y=srednie_bezrobocie, fill=Płeć)) + 
  geom_bar(stat="identity", position = "dodge") +
  labs(y = "Stopa bezrobocia",
       x = "Rok")
```

Na powyższym wykresie widzimy, że w latach 2015-2024 krajowa stopa bezrobocia wykazywała trend malejący z przejściowym wzrostem w 2020 roku. Ten okres pokrywa się z początkiem pandemii COVID-19, która wywołała szok gospodarczy doprowadzający do masowych zwolnień w wielu miejscach pracy. W roku 2021 i 2022 bezrobocie znowu zaczyna spadać a następnie stabilizuje się na poziomie między 3% a 4%. Warto odnotować także, że w każdym roku stopa bezrobocia dla kobiet była wyższa niż dla mężczyzn.

### Stopa bezrobocia dla powiatów liczących powyżej i poniżej 100 tyś. mieszkańców

Sprawdzimy teraz, czy wartość stopy bezrobocia w poszczególnych latach wygląda tak samo w liczniejszych względem ludności powiatach, jak w mniej licznych. Za „liczniejszy" powiat uznajemy taki, w którym mieszka co najmniej 100 tysięcy mieszkańców. Wyniki analizy zostały przedstawione na dwóch kolejnych wykresach (Rysunek 2 i 3).

```{r}
#| label: fig_2
#| fig-cap: "Średnia krajowa stopa bezrobocia w ostatnich 10 latach (duże powiaty)"
data_mod |> filter(Ludność >= 100000) |>
  group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = sum(Bezrobotni)/sum(Ludność_wiek_prod)) |>
  ggplot(aes(x=factor(Rok), y=srednie_bezrobocie, fill=Płeć)) + 
  geom_bar(stat="identity", position = "dodge") +
  labs(y = "Stopa bezrobocia",
       x = "Rok")
```

```{r}
#| label: fig_3
#| fig-cap: "Średnia krajowa stopa bezrobocia w ostatnich 10 latach (małe powiaty)"
data_mod |> filter(Ludność < 100000) |>
  group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = sum(Bezrobotni)/sum(Ludność_wiek_prod)) |>
  ggplot(aes(x=factor(Rok), y=srednie_bezrobocie, fill=Płeć)) + 
  geom_bar(stat="identity", position = "dodge") +
  labs(y = "Stopa bezrobocia",
       x = "Rok")
```

Na powyższych wykresach widzimy, że zarówno trend spadkowy z nagłym wzrostem w 2020, jak i wyższe bezrobocie wśród kobiet, zostają utrzymane w obu przypadkach. Zauważalną różnicą jest natomiast fakt, że mniej liczne pod względem ludności powiaty charakteryzują się wyższą stopą bezrobocia we wszystkich badanych latach. Różnica ta wynosi od około 1,5 do 3 punktów procentowych.

```{r}
duze <- data_mod |>
  filter(Ludność >= 100000) |>
  mutate(Typ_miasta = "Duże miasta") |>
  group_by(Rok, Płeć, Typ_miasta) |>
  summarize(srednie_bezrobocie = round(mean(stopa_bezrobocia),3), .groups = "drop")

male <- data_mod |>
  filter(Ludność < 100000) |>
  mutate(Typ_miasta = "Małe miasta") |>
  group_by(Rok, Płeć, Typ_miasta) |>
  summarize(srednie_bezrobocie = round(mean(stopa_bezrobocia),3), .groups = "drop")

wszystkie <- bind_rows(duze, male)

tab <- wszystkie |>
  pivot_wider(
    names_from = Rok,
    values_from = srednie_bezrobocie
  )

knitr::kable(
  tab,
  booktabs = FALSE,
  caption = "Średnia stopa bezrobocia w miastach według typów, płci i roku"
)

```
### Rozkład stopy bezrobocia w powiatach

Na podstawie przyjętych danych obliczymy teraz stopę bezrobocia dla każdego powiatu w każdym roku. Sprawdzimy, jak wygląda rozkład stopy bezrobocia w powiatach dla każdego roku. Wyniki zostały przedstawione na wykresie pudełkowym poniżej (Rysunek 4).
```{r}
#| label: fig_4
#| fig-cap: "Rozkład stopy bezrobocia w powiatach przez ostanie 10 lat"
data_mod |> filter(Płeć == "ogółem") |>
  group_by(Rok) |> 
  ggplot(aes(x=factor(Rok), y=stopa_bezrobocia)) + geom_boxplot() + 
  labs(x = "Rok",
       y = "Stopa bezrobocia")
```
Na wykresie obserwujemy podobne zależności co na wykresach z krajową stopą bezrobocia. Mediana powiatowej stopy bezrobocia maleje od 2015 do 2019 roku z późniejszym skokiem w górę w 2020 roku. Później natomiast znowu maleje i stabilizuje się na poziomie około 3,75%. Dodatkowo, wraz z medianą maleje także rozstęp międzykwartylowy, co oznacza, że różnice w stopach bezrobocia między „typowymi” powiatami maleją, zatem bezrobocie staje się coraz bardziej wyrównane w powiatach w kolejnych latach. Rozkłady stóp bezrobocia w każdym roku są prawostronnie skośne. Oznacza to, że w każdym roku istnieją takie powiaty ze stosunkowo wysokim bezrobociem.

### Czy istnieje zależnośc między stopą bezrobocia, a wynagrodzeniem brutto w powiecie?
Żeby sprawdzić, czy istnieje zależność liniowa wykonamy wykres punktowy wartości stóp bezrobocia od wynagrodzenia przeciętnego brutto w poszczególnych powiatach. Poniższy wykres prezentuje te dane dla 2024 roku (Rysunek 5).
```{r}
#| label: fig_5
#| fig-cap: "Zależność stopy bezrobocia od wynagrodzenia brutto w 2024 roku"
data_mod |> filter(Płeć == "ogółem", Rok == 2024) |>
  ggplot(aes(x=Wynagrodzenie_przeciętne, y=stopa_bezrobocia)) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE) +
  labs(x = "Wynagrodzenie przeciętne",
       y = "Stopa bezrobocia")
```
Na powyższym wykresie możemy zaobserwować, że istnieją powiaty zarówno ze stosunkowo niskim bezrobociem i wynagrodzeniem, jak i powiaty z wysokim wynagrodzeniem i niskim bezrobociem. Większość danych tworzy „chmurę", która jest słabo dopasowana do linii regresji. Stąd wnioskujemy, że dane są słabo skorelowane. Możemy sprawdzić, czy dane będą także słabo skorelowane dla poprzednich lat, obliczając współczynnik korelacji Pearsona dla każdego roku.
```{r}
tab <- data_mod |> filter(Płeć == "ogółem") |> group_by(Rok) |> summarize(r = round(cor(stopa_bezrobocia, Wynagrodzenie_przeciętne),2))

tab_t <- cbind(
  Rok = "r",
  t(tab$r)
)

colnames(tab_t) <- c("Rok", tab$Rok)

tab_t |>
  kable(
    caption = "Korelacja stopy bezrobocia z wynagrodzeniem przeciętnym brutto",
    digits = 2,
    align = "c"
  ) |>
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover")
  )
```
Na podstawie powyższych danych widzimy, że w każdym roku współczynnik korelacji utrzymuje się na poziomie ok. -0.3, co oznacza, że stopa bezrobocia jest słabo skorelowana z wynagrodzeniem przeciętnym brutto.

### Badanie zależności między ludnością w wieku produkcyjnym a liczbą bezrobotnych

Zbadamy teraz zależność liczby bezrobotnych od ludności w wieku produkcyjnym w powiatach. Dla danych dotyczących ludności możemy zaobserwować dużą dysproporcję w powiatach. W Polsce istnieją zarówno powiaty z bardzo małą liczbą ludności, jak i wielkie aglomeracje miejskie. W poniższej tabelce został pokazany rozkład danych ludności w wieku produkcyjnym w powiatach dla lat 2015-2024.
```{r}
#| label: tab_q
tabela <- data_mod |> filter(Płeć == "ogółem") |>
  group_by(Rok) |>
  summarize(
    Min = min(Ludność_wiek_prod),
    Q1 = quantile(Ludność_wiek_prod, 0.25),
    Mediana = quantile(Ludność_wiek_prod, 0.50),
    Q3 = quantile(Ludność_wiek_prod, 0.75),
    Max = max(Ludność_wiek_prod)
  )


tabela |>
  kable(
    caption = "Rozkład ludności w wieku produkcyjnym w powiatach",
    digits = 2,
    align = "c"
  ) |>
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover")
  )

```
Zauważmy, że wartości maksymalne sięgają aż do miliona, co jest bardzo znaczącą różnicą względem kwartyli nie przekraczających wartości nawet stu tysięcy osób. Wnioskujemy stąd prawostronną skośność rozkładu. Sprawdzimy zatem zależność między liczbą osób bezrobotnych a ludnością w wieku produkcyjnym posługując się wykresem punktowym z osiami w skali logarytmicznej (Rysunek 6).
```{r}
#| label: fig_6
#| fig-cap: "Zależność liczby bezrobotnych od ludności w wieku produkcyjnym w 2024 r. (skala logarytmiczna)"
data_mod |> filter(Płeć == "ogółem", Rok == 2024) |>
  ggplot(aes(x=log(Ludność_wiek_prod), y=log(Bezrobotni))) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE) +
  labs(x = "Liczba mieszkańców powiatu w wieku produkcyjnym",
       y = "Liczba bezrobotnych")
```

```{r}

data_og_2024 <- data_mod |> filter(Płeć == "ogółem", Rok == 2024)
model <- lm(log(Bezrobotni) ~ log(Ludność_wiek_prod), data=data_og_2024)
```

Pomimo tego, że punkty nie są dopasowane idealnie, to jednak układają się wzdłuż linii prostej. Dodatkowo, obserwujemy, że im więcej ludności w wieku produkcyjnym, tym jest więcej bezrobotnych w powiecie. Wnioskujemy zatem, że zachodzi dodatnia zależność liniowa w skali logarytmicznej. Oznacza to, że zależność między oryginalnymi zmiennymi ma charakter potęgowy. Dostajemy zależność
$$
\text{Bezrobotni} = a \cdot \text{(Ludność w wieku produkcyjnym)}^b.
$$
Wyliczając za pomocą regresji liniowej dostajemy współczynniki
$$
a = `r round(coef(model)[1], 2)` \quad | \ b = `r round(coef(model)[2], 2)`.
$$
Obliczymy teraz współczynnik korelacji Pearsona dla zlogarytmowanych danych dla lat 2015-2024, żeby sprawdzić, czy w poprzednich latach zachodzi podobna zależność.
```{r}
tab <- data_mod |> filter(Płeć == "ogółem") |> group_by(Rok) |> summarize(r = round(cor(log(Bezrobotni), log(Ludność_wiek_prod)),2))

tab_t <- cbind(
  Rok = "r",
  t(tab$r)
)

colnames(tab_t) <- c("Rok", tab$Rok)

tab_t |>
  kable(
    caption = "Korelacja liczby osób bezrobotnych z ludnością w wieku produkcyjnym (skala logarytmiczna)",
    digits = 2,
    align = "c"
  ) |>
  kable_styling(
    full_width = FALSE,
    bootstrap_options = c("striped", "hover")
  )
```
Na podstawie powyższych danych widzimy, że w każdym roku współczynnik korelacji utrzymuje się na poziomie ok. 0.75, co oznacza, że liczba osób bezrobotnych jest  skorelowana dodatnio z ludnością w wieku produkcyjnym.

# Bibliografia
