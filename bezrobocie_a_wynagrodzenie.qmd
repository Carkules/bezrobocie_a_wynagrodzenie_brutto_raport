---
title: "bezrobocie_wynagrodzenie"
format: html
editor: visual
execute:
  echo: false
  warning: false
  message: false
---

# Analiza bezrobocia rejestrowanego w Polsce w latach 2015-2024 na poziomie powiatów

## Wstęp

Bezrobocie rejestrowane to forma bezrobocia obejmująca osoby, które zgłosiły się do powiatowego urzędu pracy i zostały wpisane do oficjalnego rejestru bezrobotnych. Oznacza to, że dana osoba nie ma zatrudnienia, aktywnie poszukuje pracy i jest gotowa ją podjąć, spełniając jednocześnie warunki określone w przepisach. Ludzie rejestrują się w urzędzie pracy z różnych powodów – przede wszystkim w celu znalezienia zatrudnienia za pośrednictwem urzędu, ale także po to, aby uzyskać wsparcie finansowe w postaci zasiłku, jeśli spełniają kryteria jego przyznania. Rejestracja zapewnia także prawo do ubezpieczenia zdrowotnego opłacanego przez państwo, co ma znaczenie szczególnie dla osób pozostających bez pracy i bez innego tytułu do ubezpieczenia. Dodatkowo zarejestrowani bezrobotni mogą korzystać z ofert bezpłatnych szkoleń, kursów zawodowych, staży czy programów aktywizacyjnych, które pomagają w powrocie na rynek pracy. Warto zaznaczyć, że bezrobocie rejestrowane jest tylko jedną z miar bezrobocia, ponieważ obejmuje wyłącznie osoby, które faktycznie zgłosiły się do urzędu – nie uwzględnia osób poszukujących pracy na własną rękę ani tych, które pracują nieformalnie (na czarno), dlatego nie odzwierciedla całkowitej liczby osób pozostających bez zatrudnienia.

## Opisanie danych

## Pytania badawcze

## Wczytanie danych

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
```

```{r}
data <- read.csv("sprawozdanie1_dane.csv")
head(data)
```

## Analiza danych

### Obliczanie wskaźnika bezrobocia

```{r}
data_mod <- data |> mutate(wskaznik_bezrobocia = Bezrobotni/Ludność_wiek_prod)

data_mod |> group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = mean(wskaznik_bezrobocia)) |>
  ggplot(aes(x=factor(Rok), y=srednie_bezrobocie, fill=Płeć)) + 
  geom_bar(stat="identity", position = "dodge") +
  labs(title = "Średni krajowy wskaźnik bezrobocia w ostatnich 10 latach",
       y = "Średni krajowy wskaźnik bezrobocia",
       x = "Rok")
```

```{r}
data_mod |> filter(Ludność >= 100000) |>
  group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = mean(wskaznik_bezrobocia)) |>
  ggplot(aes(x=factor(Rok), y=srednie_bezrobocie, fill=Płeć)) + 
  geom_bar(stat="identity", position = "dodge") +
  labs(title = "Średni krajowy wskaźnik bezrobocia w ostatnich 10 latach (duże powiaty)",
       y = "Średni krajowy wskaźnik bezrobocia",
       x = "Rok")
```

```{r}
data_mod |> filter(Ludność < 100000) |>
  group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = mean(wskaznik_bezrobocia)) |>
  ggplot(aes(x=factor(Rok), y=srednie_bezrobocie, fill=Płeć)) + 
  geom_bar(stat="identity", position = "dodge") +
  labs(title = "Średni krajowy wskaźnik bezrobocia w ostatnich 10 latach (małe powiaty)",
       y = "Średni krajowy wskaźnik bezrobocia",
       x = "Rok")
```

```{r}
śr_r_bezrob_duże_miasta <- data_mod |> filter(Ludność >= 100000) |>
  group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = round(mean(wskaznik_bezrobocia),3))

tab <- śr_r_bezrob_duże_miasta |> pivot_wider(
  names_from = Rok,
  values_from = srednie_bezrobocie
)
tab

śr_r_bezrob_male_miasta <- data_mod |> filter(Ludność < 100000) |>
  group_by(Rok, Płeć) |> summarize(srednie_bezrobocie = round(mean(wskaznik_bezrobocia),3))

tab2 <- śr_r_bezrob_male_miasta |> pivot_wider(
  names_from = Rok,
  values_from = srednie_bezrobocie
)
tab2
```

```         
```

```{r}
data_mod |> filter(Płeć == "ogółem") |>
  group_by(Rok) |> 
  ggplot(aes(x=factor(Rok), y=wskaznik_bezrobocia)) + geom_boxplot()
```

```{r}
data_mod |> filter(Płeć == "ogółem", Rok == 2024) |>
  ggplot(aes(x=Wynagrodzenie_przeciętne, y=wskaznik_bezrobocia)) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE)
```

```{r}
data_mod |> filter(Płeć == "ogółem", Rok == 2024) |>
  ggplot(aes(x=log(Ludność), y=log(Bezrobotni))) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE)
```

```{r}
data_mod |> filter(Płeć == "ogółem", Rok == 2024) |>
  ggplot(aes(x=log(Ludność_wiek_prod), y=log(Bezrobotni))) +
  geom_point() +
  geom_smooth(method="lm", se=FALSE)
```
